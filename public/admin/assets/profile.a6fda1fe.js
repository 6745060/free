import{_ as y}from"./index.95b9a161.js";import{e as U,q as F,aW as c,an as x,a3 as I,aY as k,b0 as S,aX as q,aZ as M,b1 as R,ab as N,o as z,g as T,h as o,w as r,u as a,j as i,Z}from"./.pnpm.aa9acb74.js";import{a as j,g as W,s as X,f as Y,b as G}from"./index.83cc6034.js";const H={class:"user-setting"},J={class:"w-80"},K={class:"w-80"},L={class:"w-80"},O={class:"w-80"},Q={class:"w-80"},$=U({__name:"profile",setup(ee){const _=F(),m=F(),p=j(),f=c({}),w="//backend/avatar/upload";x(()=>{f.Authorization="Bearer "+W()});const e=c({avatar:"",account:"",name:"",currentPassword:"",newPassword:"",confirmPassword:""}),B=c({avatar:[{required:!0,message:"\u5934\u50CF\u4E0D\u80FD\u4E3A\u7A7A",trigger:["change"]}],account:[{required:!0,message:"\u8BF7\u8F93\u5165\u767B\u5F55\u8D26\u53F7",trigger:["blur"]}],name:[{required:!0,message:"\u8BF7\u8F93\u5165\u7528\u6237\u6635\u79F0",trigger:["blur"]}],currentPassword:[{validator:(t,u,s)=>{e.newPassword&&(u||s(new Error("\u8BF7\u8F93\u5165\u5F53\u524D\u5BC6\u7801"))),s()},trigger:"blur"}],newPassword:[{validator:(t,u,s)=>{e.currentPassword&&(u||s(new Error("\u8BF7\u8F93\u5165\u65B0\u7684\u5BC6\u7801"))),s()},trigger:"blur"}],confirmPassword:[{validator:(t,u,s)=>{e.newPassword&&(u||s(new Error("\u8BF7\u518D\u6B21\u8F93\u5165\u5BC6\u7801")),u!==e.newPassword&&s(new Error("\u4E24\u6B21\u8F93\u5165\u5BC6\u7801\u4E0D\u4E00\u81F4!"))),s()},trigger:"blur"}]}),E=t=>{e.avatar=t.data.url},v=async()=>{const t=p.userInfo;for(const u in e)e[u]=t[u]},g=async()=>{await X(e),Y.msgSuccess("\u4FDD\u5B58\u6210\u529F"),await p.getUserInfo()},b=()=>{_.value.submit()},C=async()=>{var t;await((t=m.value)==null?void 0:t.validate()),await g()};return v(),(t,u)=>{const s=I,n=k,P=S,d=q,A=M,V=R,h=N,D=y;return z(),T("div",H,[o(V,{class:"!border-none",shadow:"never"},{default:r(()=>[o(A,{ref_key:"formRef",ref:m,class:"ls-form",model:a(e),rules:a(B),"label-width":"100px"},{default:r(()=>[o(P,{ref_key:"uploadRef",ref:_,name:"avatar",action:w,headers:a(f),"on-success":E,"show-file-list":!1,"auto-upload":!0,limit:1},{default:r(()=>[o(n,{label:"\u7528\u6237\u5934\u50CF\uFF1A",prop:"avatar"},{default:r(()=>[o(s,{size:80,src:a(e).avatar,onClick:b},null,8,["src"])]),_:1})]),_:1},8,["headers"]),o(n,{label:"\u767B\u5F55\u8D26\u53F7\uFF1A",prop:"account"},{default:r(()=>[i("div",J,[o(d,{modelValue:a(e).account,"onUpdate:modelValue":u[0]||(u[0]=l=>a(e).account=l)},null,8,["modelValue"])])]),_:1}),o(n,{label:"\u7528\u6237\u6635\u79F0\uFF1A",prop:"name"},{default:r(()=>[i("div",K,[o(d,{modelValue:a(e).name,"onUpdate:modelValue":u[1]||(u[1]=l=>a(e).name=l),placeholder:"\u8BF7\u8F93\u5165\u7528\u6237\u6635\u79F0"},null,8,["modelValue"])])]),_:1}),o(n,{label:"\u5F53\u524D\u5BC6\u7801\uFF1A",prop:"currentPassword"},{default:r(()=>[i("div",L,[o(d,{modelValue:a(e).currentPassword,"onUpdate:modelValue":u[2]||(u[2]=l=>a(e).currentPassword=l),modelModifiers:{trim:!0},placeholder:"\u4FEE\u6539\u5BC6\u7801\u65F6\u5FC5\u586B, \u4E0D\u4FEE\u6539\u5BC6\u7801\u65F6\u7559\u7A7A",type:"password","show-password":""},null,8,["modelValue"])])]),_:1}),o(n,{label:"\u65B0\u7684\u5BC6\u7801\uFF1A",prop:"newPassword"},{default:r(()=>[i("div",O,[o(d,{modelValue:a(e).newPassword,"onUpdate:modelValue":u[3]||(u[3]=l=>a(e).newPassword=l),modelModifiers:{trim:!0},placeholder:"\u4FEE\u6539\u5BC6\u7801\u65F6\u5FC5\u586B, \u4E0D\u4FEE\u6539\u5BC6\u7801\u65F6\u7559\u7A7A",type:"password","show-password":""},null,8,["modelValue"])])]),_:1}),o(n,{label:"\u786E\u8BA4\u5BC6\u7801\uFF1A",prop:"confirmPassword"},{default:r(()=>[i("div",Q,[o(d,{modelValue:a(e).confirmPassword,"onUpdate:modelValue":u[4]||(u[4]=l=>a(e).confirmPassword=l),modelModifiers:{trim:!0},placeholder:"\u4FEE\u6539\u5BC6\u7801\u65F6\u5FC5\u586B, \u4E0D\u4FEE\u6539\u5BC6\u7801\u65F6\u7559\u7A7A",type:"password","show-password":""},null,8,["modelValue"])])]),_:1})]),_:1},8,["model","rules"])]),_:1}),o(D,null,{default:r(()=>[o(h,{type:"primary",onClick:C},{default:r(()=>[Z("\u4FDD\u5B58")]),_:1})]),_:1})])}}});const se=G($,[["__scopeId","data-v-bab6e292"]]);export{se as default};
