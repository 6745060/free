import{P as ye}from"./index.6fbe50e6.js";import{e as K,o,g as p,G as de,bn as q,h as t,m as w,s as ee,q as k,f as Y,b8 as ll,bo as tl,w as a,k as $,j as i,N,O as X,y as oe,b0 as nl,bb as Ue,aW as xe,$ as al,z as be,B as ol,x as sl,u as l,bp as il,W as J,bq as ul,C as F,D as ie,V as G,am as ge,br as Le,bs as dl,an as rl,bt as cl,be as ml,bf as pl,b3 as fl,bu as _l,b5 as vl,bm as hl,b6 as gl,Z as A,a$ as yl,F as ue,a4 as bl,a5 as Cl,a6 as wl,E as Te,ab as kl,aX as El,v as Al,a_ as Sl,ad as je,ae as Me,bv as Fl,ap as $l,bd as Ie,n as ve,bc as Vl}from"./.pnpm.aa9acb74.js";import{u as Dl,_ as Bl}from"./usePaging.360c2585.js";import{b as le,_ as re,a as Rl,e as he,R as zl,f as H,r as W,h as Pl,u as Il}from"./index.83cc6034.js";import{_ as Ul}from"./index.vue_vue_type_script_setup_true_lang.2f2e2567.js";const xl=K({props:{showClose:{type:Boolean,default:!0}},emits:["close"],setup(e,{emit:r}){return{handleClose:()=>{r("close")}}}});const Ll={class:"del-wrap"};function Tl(e,r,y,c,v,S){const u=re;return o(),p("div",Ll,[de(e.$slots,"default",{},void 0,!0),e.showClose?(o(),p("div",{key:0,class:"icon-close",onClick:r[0]||(r[0]=q((...d)=>e.handleClose&&e.handleClose(...d),["stop"]))},[t(u,{size:12,name:"el-icon-CloseBold"})])):w("",!0)])}const Ne=le(xl,[["render",Tl],["__scopeId","data-v-2a98aa67"]]),jl=K({components:{},props:{type:{type:String,default:"image"},multiple:{type:Boolean,default:!0},limit:{type:Number,default:10},data:{type:Object,default:()=>({})},showProgress:{type:Boolean,default:!1}},emits:["change","error"],setup(e,{emit:r}){const y=Rl(),c=ee(),v=k(`${he.baseUrl}${he.urlPrefix}/common/upload/${e.type}`),S=Y(()=>({token:y.token,version:he.version})),u=k(!1),d=k([]),f=(h,R,V)=>{u.value=!0,d.value=ll(V)},m=(h,R,V)=>{var z;V.every(U=>U.status=="success")&&((z=c.value)==null||z.clearFiles(),u.value=!1,r("change")),h.code==zl.FAILED&&h.msg&&H.msgError(h.msg)},g=(h,R)=>{var V;H.msgError(`${R.name}\u6587\u4EF6\u4E0A\u4F20\u5931\u8D25`),(V=c.value)==null||V.abort(R),u.value=!1,r("change"),r("error")},_=()=>{H.msgError(`\u8D85\u51FA\u4E0A\u4F20\u4E0A\u9650${e.limit}\uFF0C\u8BF7\u91CD\u65B0\u4E0A\u4F20`)},I=()=>{var h;(h=c.value)==null||h.clearFiles(),u.value=!1},j=Y(()=>{switch(e.type){case"image":return".jpj,.png,.gif,.jpeg,.ico,.bmp";case"video":return".wmv,.avi,.mov,.mp4,.flv,.rmvb";default:return"*"}});return{uploadRefs:c,action:v,headers:S,visible:u,fileList:d,getAccept:j,handleProgress:f,handleSuccess:m,handleError:g,handleExceed:_,handleClose:I}}}),Ml={class:"upload"},Nl={class:"file-list p-4"},Wl={class:"flex-1"};function Gl(e,r,y,c,v,S){const u=nl,d=tl,f=Ue;return o(),p("div",Ml,[t(u,{ref:"uploadRefs",action:e.action,multiple:e.multiple,limit:e.limit,"show-file-list":!1,headers:e.headers,data:e.data,"on-progress":e.handleProgress,"on-success":e.handleSuccess,"on-exceed":e.handleExceed,"on-error":e.handleError,accept:e.getAccept},{default:a(()=>[de(e.$slots,"default")]),_:3},8,["action","multiple","limit","headers","data","on-progress","on-success","on-exceed","on-error","accept"]),e.showProgress&&e.fileList.length?(o(),$(f,{key:0,modelValue:e.visible,"onUpdate:modelValue":r[0]||(r[0]=m=>e.visible=m),title:"\u4E0A\u4F20\u8FDB\u5EA6","close-on-click-modal":!1,width:"500px",modal:!1,onClose:e.handleClose},{default:a(()=>[i("div",Nl,[(o(!0),p(N,null,X(e.fileList,(m,g)=>(o(),p("div",{key:g,class:"mb-5"},[i("div",null,oe(m.name),1),i("div",Wl,[t(d,{percentage:parseInt(m.percentage)},null,8,["percentage"])])]))),128))])]),_:1},8,["modelValue","onClose"])):w("",!0)])}const ql=le(jl,[["render",Gl]]),Yl="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAgCAYAAABgrToAAAACJElEQVRYR+2YMWsUURSFz3m7s+nskjUIQSutbMRi7WzUVjSadMHCbVLkByjmLygaCVYWRqMEUhkFS9Gg0cJfYCPZjYUQFbPs+I7c2R1Q2ZjZfRNYYS4MAzPv3vnmvDvL3kMA2Hl5/CjLI9ckf4ZwY3Zt15C+gfwIao3So0rt3XsJtPUk9M/cAW6y9ap2DIyfAjgCwANwGeoYiEFtk/5e5CvXeer1D2neATcGgiTZM4+t9RNLEKcBtAFEGeBsiRWzl7EoSXo+8rV9gWc/fDc1B1VSEoEnDpj0KTB33tS26DGaEezvZQZpRxmODyoT5+vwBwS3zeTcT4yjTdZNJEiPSykk1bjZX6HeD/WQJ1zUApgq2w+etcsniBuAVlH9vELOx6Yo1VywgkmTB4X1kEGGhyAtg/Ecq3NNqnknDwVTrNBaactEts88OHs5b8Bw/Tof4M+kr4WrwwhoL9n5uRPWhxWwsxPEl+EGNMacP5I8evCPGgVgqKSFgoWCoQqE5hc9WCgYqkBoftGDeSiYz1/+UJLe+foftvh2A2B1fwQIrapkaFoDcK4PVyH0qVnyU4fjGdW4NQ2WlgDE5hLkMoJmQdh9zW9Dk59K5lhtLjyE01TX/jDILP5MGEbvbFPOJroIXvc5PjvTBbx7GM4vAjjd9WdSc2g/IPaqaTv5Aq58haP1TSb2Au20GGErvgTxIqiTAA7tVSnn+2Z9vAXdCsa4bD6Nsf0C/gYA5PMzcW0AAAAASUVORK5CYII=";function Kl(e){return W.post({url:"/common/album/cateAdd",params:e})}function Zl(e){return W.post({url:"/common/album/cateRename",params:e})}function Ol(e){return W.post({url:"/common/album/cateDel",params:e})}function Ql(e){return W.get({url:"/common/album/cateList",params:e})}function Xl(e){return W.get({url:"/common/album/albumList",params:e})}function Jl(e){return W.post({url:"/common/album/albumDel",params:e})}function Hl(e){return W.post({url:"/common/album/albumMove",params:e})}function et(e){return W.post({url:"/common/album/albumRename",params:e})}function lt(e){const r=ee(),y=k([]),c=k(""),v=async()=>{const m=await Ql({type:e}),g=[];y.value=m,y.value.unshift(...g),setTimeout(()=>{var _;(_=r.value)==null||_.setCurrentKey(c.value)},0)};return{treeRef:r,cateId:c,cateLists:y,handleAddCate:async m=>{await Kl({type:e,name:m,pid:0}),v()},handleEditCate:async(m,g)=>{await Zl({id:g,name:m}),v()},handleDeleteCate:async m=>{await H.confirm("\u786E\u5B9A\u8981\u5220\u9664\uFF1F"),await Ol({id:m}),c.value="",v()},getCateLists:v,handleCatSelect:m=>{c.value=m.id}}}function tt(e,r,y,c){const v=ee(),S=k("normal"),u=k(0),d=k([]),f=k(!1),m=k(!1),g=xe({name:"",type:r,cid:e}),{pager:_,getLists:I,resetPage:j}=Dl({fetchFun:Xl,params:g,firstLoading:!0,size:c}),h=()=>{I()},R=()=>{j()},V=s=>!!d.value.find(b=>b.id==s),Z=async s=>{await H.confirm("\u786E\u8BA4\u5220\u9664\u540E\uFF0C\u672C\u5730\u6216\u4E91\u5B58\u50A8\u6587\u4EF6\u4E5F\u5C06\u540C\u6B65\u5220\u9664\uFF0C\u5982\u6587\u4EF6\u5DF2\u88AB\u4F7F\u7528\uFF0C\u8BF7\u8C28\u614E\u64CD\u4F5C\uFF01");const b=s||d.value.map(M=>M.id);await Jl({ids:b}),h(),E()},z=async()=>{const s=d.value.map(b=>b.id);await Hl({ids:s,cid:u.value}),u.value=0,h(),E()},U=s=>{const b=d.value.findIndex(M=>M.id==s.id);if(b!=-1){d.value.splice(b,1);return}if(d.value.length==y.value){if(y.value==1){d.value=[],d.value.push(s);return}al.warning("\u5DF2\u8FBE\u5230\u9009\u62E9\u4E0A\u9650");return}d.value.push(s)},E=()=>{d.value=[]};return{listShowType:S,tableRef:v,moveId:u,pager:_,fileParams:g,select:d,isCheckAll:f,isIndeterminate:m,getFileList:h,refresh:R,batchFileDelete:Z,batchFileMove:z,selectFile:U,isSelect:V,clearSelect:E,cancelSelete:s=>{d.value=d.value.filter(b=>b.id!=s)},selectAll:s=>{var b;if(m.value=!1,(b=v.value)==null||b.toggleAllSelection(),s){d.value=[..._.lists];return}E()},handleFileRename:async(s,b)=>{await et({id:b,name:s}),h()}}}const nt=K({props:{uri:{type:String},fileSize:{type:String,default:"100px"},type:{type:String,default:"image"}},emits:["close"]});const at=["src"],ot={key:2,class:"absolute left-1/2 top-1/2 translate-x-[-50%] translate-y-[-50%] rounded-full w-5 h-5 flex justify-center items-center bg-[rgba(0,0,0,0.3)]"};function st(e,r,y,c,v,S){const u=ol,d=re;return o(),p("div",null,[i("div",{class:"file-item relative",style:be({height:e.fileSize,width:e.fileSize})},[e.type=="image"?(o(),$(u,{key:0,class:"image",fit:"contain",src:e.uri},null,8,["src"])):e.type=="video"?(o(),p("video",{key:1,class:"video",src:e.uri},null,8,at)):w("",!0),e.type=="video"?(o(),p("div",ot,[t(d,{name:"el-icon-CaretRight",size:18,color:"#fff"})])):w("",!0),de(e.$slots,"default",{},void 0,!0)],4)])}const se=le(nt,[["render",st],["__scopeId","data-v-ec4ebd66"]]),it=K({__name:"index",props:{src:{type:String,required:!0},width:String,height:String,poster:String},setup(e,{expose:r}){const y=e,c=ee(),v=xe({color:"var(--el-color-primary)",muted:!1,webFullScreen:!1,speedRate:["0.75","1.0","1.25","1.5","2.0"],autoPlay:!0,loop:!1,mirror:!1,ligthOff:!1,volume:.3,control:!0,title:"",poster:"",...y}),S=()=>{c.value.play()},u=()=>{c.value.pause()},d=_=>{console.log(_,"\u64AD\u653E")},f=_=>{console.log(_,"\u6682\u505C")},m=_=>{console.log(_,"\u65F6\u95F4\u66F4\u65B0")},g=_=>{console.log(_,"\u53EF\u4EE5\u64AD\u653E")};return r({play:S,pause:u}),(_,I)=>(o(),p("div",null,[t(l(il),sl({ref_key:"playerRef",ref:c},v,{src:e.src,onPlay:d,onPause:f,onTimeupdate:m,onCanplay:g}),null,16,["src"])]))}}),ut={key:0},dt={key:1},We=K({__name:"preview",props:{modelValue:{type:Boolean,default:!1},url:{type:String,default:""},type:{type:String,default:"image"}},emits:["update:modelValue"],setup(e,{emit:r}){const y=e,c=ee(),v=Y({get(){return y.modelValue},set(d){r("update:modelValue",d)}}),S=()=>{r("update:modelValue",!1)},u=k([]);return J(()=>y.modelValue,d=>{d?ge(()=>{var f;u.value=[y.url],(f=c.value)==null||f.play()}):ge(()=>{var f;u.value=[],(f=c.value)==null||f.pause()})}),(d,f)=>{const m=ul,g=it,_=Ue;return F((o(),p("div",null,[e.type=="image"?(o(),p("div",ut,[l(u).length?(o(),$(m,{key:0,"url-list":l(u),"hide-on-click-modal":"",onClose:S},null,8,["url-list"])):w("",!0)])):w("",!0),e.type=="video"?(o(),p("div",dt,[t(_,{modelValue:l(v),"onUpdate:modelValue":f[0]||(f[0]=I=>G(v)?v.value=I:null),width:"740px",title:"\u89C6\u9891\u9884\u89C8","before-close":S},{default:a(()=>[t(g,{ref_key:"playerRef",ref:c,src:e.url,width:"100%",height:"450px"},null,8,["src"])]),_:1},8,["modelValue"])])):w("",!0)],512)),[[ie,e.modelValue]])}}}),ce=e=>(je("data-v-49f20224"),e=e(),Me(),e),rt={class:"material"},ct={class:"material__left"},mt={class:"flex-1 min-h-0"},pt={class:"material-left__content pt-4 p-b-4"},ft={class:"flex flex-1 items-center min-w-0 pr-4"},_t=ce(()=>i("img",{class:"w-[20px] h-[16px] mr-3",src:Yl},null,-1)),vt={class:"flex-1 truncate mr-2"},ht=ce(()=>i("span",{class:"muted m-r-10"},"\xB7\xB7\xB7",-1)),gt=["onClick"],yt={class:"flex justify-center p-2 border-t border-br"},bt={class:"material__center flex flex-col"},Ct={class:"operate-btn flex"},wt={class:"flex-1 flex"},kt=ce(()=>i("span",{class:"mr-5"},"\u79FB\u52A8\u6587\u4EF6\u81F3",-1)),Et={class:"flex items-center ml-2"},At={key:0,class:"mt-3"},St={class:"material-center__content flex flex-col flex-1 mb-1 min-h-0"},Ft={class:"file-list flex flex-wrap mt-4"},$t={key:0,class:"item-selected"},Vt={class:"operation-btns flex items-center"},Dt={class:"inline-block"},Bt={class:"inline-block"},Rt={class:"inline-block"},zt={key:1,class:"flex flex-1 justify-center items-center"},Pt={class:"material-center__footer flex justify-between items-center mt-2"},It={class:"flex"},Ut={class:"mr-3"},xt=ce(()=>i("span",{class:"mr-5"},"\u79FB\u52A8\u6587\u4EF6\u81F3",-1)),Lt={key:0,class:"material__right"},Tt={class:"flex justify-between p-2 flex-wrap"},jt={class:"sm flex items-center"},Mt={key:0},Nt={class:"flex-1 min-h-0"},Wt={class:"select-lists flex flex-col p-t-3"},Gt={class:"select-item"},qt=K({__name:"index",props:{fileSize:{type:String,default:"100px"},limit:{type:Number,default:1},type:{type:String,default:"image"},mode:{type:String,default:"picker"},pageSize:{type:Number,default:15}},emits:["change"],setup(e,{expose:r,emit:y}){const c=e,{limit:v}=Le(c),S=Y(()=>{switch(c.type){case"image":return 10;case"video":return 20;case"file":return 30;default:return 0}}),u=dl("visible"),d=k(""),f=k(!1),{treeRef:m,cateId:g,cateLists:_,handleAddCate:I,handleEditCate:j,handleDeleteCate:h,getCateLists:R,handleCatSelect:V}=lt(S.value),{tableRef:Z,listShowType:z,moveId:U,pager:E,fileParams:O,select:x,isCheckAll:L,isIndeterminate:s,getFileList:b,refresh:M,batchFileDelete:te,batchFileMove:Ce,selectFile:me,isSelect:we,clearSelect:ke,cancelSelete:Ye,selectAll:Ee,handleFileRename:Ae}=tt(g,S,v,c.pageSize),Se=async()=>{var T;await R(),(T=m.value)==null||T.setCurrentKey(g.value),b()},pe=T=>{d.value=T,f.value=!0};return J(u,async T=>{T&&Se()},{immediate:!0}),J(g,()=>{O.name="",M()}),J(x,T=>{if(y("change",T),T.length==E.lists.length&&T.length!==0){s.value=!1,L.value=!0;return}T.length>0?s.value=!0:(L.value=!1,s.value=!1)},{deep:!0}),rl(()=>{c.mode=="page"&&Se()}),r({clearSelect:ke}),(T,C)=>{const Fe=Pl,$e=bl,ne=Ul,Ke=Cl,Ze=wl,Oe=cl,fe=Te,D=kl,Ve=ql,De=ml,Be=pl,Re=ye,ae=re,Qe=El,ze=Al,_e=Sl,Pe=Ne,Q=fl,Xe=_l,Je=vl,He=Bl,P=hl("perms"),el=gl;return F((o(),p("div",rt,[i("div",ct,[i("div",mt,[t(fe,null,{default:a(()=>[i("div",pt,[t(Oe,{ref_key:"treeRef",ref:m,"node-key":"id",data:l(_),"empty-text":"''","highlight-current":!0,"expand-on-click-node":!1,"current-node-key":l(g),onNodeClick:l(V)},{default:a(({data:n})=>[i("div",ft,[_t,i("span",vt,[t(Fe,{content:n.name},null,8,["content"])]),n.id>0?F((o(),$(Ze,{key:0,"hide-on-click":!1},{dropdown:a(()=>[t(Ke,null,{default:a(()=>[F((o(),$(ne,{onConfirm:B=>l(j)(B,n.id),size:"default",value:n.name,width:"400px",limit:20,"show-limit":"",teleported:""},{default:a(()=>[i("div",null,[t($e,null,{default:a(()=>[A(" \u547D\u540D\u5206\u7EC4 ")]),_:1})])]),_:2},1032,["onConfirm","value"])),[[P,["common:album:cateRename"]]]),F((o(),p("div",{onClick:B=>l(h)(n.id)},[t($e,null,{default:a(()=>[A("\u5220\u9664\u5206\u7EC4")]),_:1})],8,gt)),[[P,["common:album:cateDel"]]])]),_:2},1024)]),default:a(()=>[ht]),_:2},1024)),[[P,["common:album:cateRename","common:album:cateDel"]]]):w("",!0)])]),_:1},8,["data","current-node-key","onNodeClick"])])]),_:1})]),i("div",yt,[F((o(),$(ne,{onConfirm:l(I),size:"default",width:"400px",limit:20,"show-limit":"",teleported:""},{default:a(()=>[t(D,null,{default:a(()=>[A(" \u6DFB\u52A0\u5206\u7EC4 ")]),_:1})]),_:1},8,["onConfirm"])),[[P,["common:album:cateAdd"]]])])]),i("div",bt,[i("div",Ct,[i("div",wt,[e.type=="image"?F((o(),$(Ve,{key:0,class:"mr-3",data:{cid:l(g)},type:e.type,"show-progress":!0,onChange:l(M)},{default:a(()=>[t(D,{type:"primary"},{default:a(()=>[A("\u672C\u5730\u4E0A\u4F20")]),_:1})]),_:1},8,["data","type","onChange"])),[[P,["common:upload:image"]]]):w("",!0),e.type=="video"?F((o(),$(Ve,{key:1,class:"mr-3",data:{cid:l(g)},type:e.type,"show-progress":!0,onChange:l(M)},{default:a(()=>[t(D,{type:"primary"},{default:a(()=>[A("\u672C\u5730\u4E0A\u4F20")]),_:1})]),_:1},8,["data","type","onChange"])),[[P,["common:upload:video"]]]):w("",!0),e.mode=="page"?F((o(),$(D,{key:2,disabled:!l(x).length,onClick:C[0]||(C[0]=q(n=>l(te)(),["stop"]))},{default:a(()=>[A(" \u5220\u9664 ")]),_:1},8,["disabled"])),[[P,["common:album:albumDel"]]]):w("",!0),e.mode=="page"?F((o(),$(Re,{key:3,class:"ml-3",onConfirm:l(Ce),disabled:!l(x).length,title:"\u79FB\u52A8\u6587\u4EF6"},{trigger:a(()=>[t(D,{disabled:!l(x).length},{default:a(()=>[A("\u79FB\u52A8")]),_:1},8,["disabled"])]),default:a(()=>[i("div",null,[kt,t(Be,{modelValue:l(U),"onUpdate:modelValue":C[1]||(C[1]=n=>G(U)?U.value=n:null),placeholder:"\u8BF7\u9009\u62E9"},{default:a(()=>[(o(!0),p(N,null,X(l(_),n=>(o(),p(N,{key:n.id},[n.id!==""?(o(),$(De,{key:0,label:n.name,value:n.id},null,8,["label","value"])):w("",!0)],64))),128))]),_:1},8,["modelValue"])])]),_:1},8,["onConfirm","disabled"])),[[P,["common:album:albumMove"]]]):w("",!0)]),t(Qe,{class:"w-60",placeholder:"\u8BF7\u8F93\u5165\u540D\u79F0",modelValue:l(O).name,"onUpdate:modelValue":C[2]||(C[2]=n=>l(O).name=n),onKeyup:yl(l(M),["enter"])},{append:a(()=>[t(D,{onClick:l(M)},{icon:a(()=>[t(ae,{name:"el-icon-Search"})]),_:1},8,["onClick"])]),_:1},8,["modelValue","onKeyup"]),i("div",Et,[t(ze,{content:"\u5217\u8868\u89C6\u56FE",placement:"top"},{default:a(()=>[i("div",{class:ue(["list-icon",{select:l(z)=="table"}]),onClick:C[3]||(C[3]=n=>z.value="table")},[t(ae,{name:"local-icon-list-2",size:18})],2)]),_:1}),t(ze,{content:"\u5E73\u94FA\u89C6\u56FE",placement:"top"},{default:a(()=>[i("div",{class:ue(["list-icon",{select:l(z)=="normal"}]),onClick:C[4]||(C[4]=n=>z.value="normal")},[t(ae,{name:"el-icon-Menu",size:18})],2)]),_:1})])]),e.mode=="page"?(o(),p("div",At,[t(_e,{disabled:!l(E).lists.length,modelValue:l(L),"onUpdate:modelValue":C[5]||(C[5]=n=>G(L)?L.value=n:null),onChange:l(Ee),indeterminate:l(s)},{default:a(()=>[A(" \u5F53\u9875\u5168\u9009 ")]),_:1},8,["disabled","modelValue","onChange","indeterminate"])])):w("",!0),i("div",St,[l(E).lists.length?F((o(),$(fe,{key:0},{default:a(()=>[i("ul",Ft,[(o(!0),p(N,null,X(l(E).lists,n=>(o(),p("li",{class:"file-item-wrap",key:n.id,style:be({width:e.fileSize})},[t(Pe,{onClose:B=>l(te)([n.id])},{default:a(()=>[t(se,{uri:n.uri,"file-size":e.fileSize,type:e.type,onClick:B=>l(me)(n)},{default:a(()=>[l(we)(n.id)?(o(),p("div",$t,[t(ae,{size:24,name:"el-icon-Check",color:"#fff"})])):w("",!0)]),_:2},1032,["uri","file-size","type","onClick"])]),_:2},1032,["onClose"]),t(Fe,{class:"mt-1",content:n.name},null,8,["content"]),i("div",Vt,[F((o(),$(ne,{onConfirm:B=>l(Ae)(B,n.id),size:"default",value:n.name,width:"400px",limit:50,"show-limit":"",teleported:""},{default:a(()=>[t(D,{type:"primary",link:""},{default:a(()=>[A(" \u91CD\u547D\u540D ")]),_:1})]),_:2},1032,["onConfirm","value"])),[[P,["common:album:albumRename"]]]),t(D,{type:"primary",link:"",onClick:B=>pe(n.uri)},{default:a(()=>[A(" \u67E5\u770B ")]),_:2},1032,["onClick"])])],4))),128))])]),_:1},512)),[[ie,l(z)=="normal"]]):w("",!0),F(t(Je,{ref_key:"tableRef",ref:Z,class:"mt-4",data:l(E).lists,width:"100%",height:"100%",size:"large",onRowClick:l(me)},{default:a(()=>[t(Q,{width:"55"},{default:a(({row:n})=>[t(_e,{modelValue:l(we)(n.id),onChange:B=>l(me)(n)},null,8,["modelValue","onChange"])]),_:1}),t(Q,{label:"\u56FE\u7247",width:"100"},{default:a(({row:n})=>[t(se,{uri:n.uri,"file-size":"50px",type:e.type},null,8,["uri","type"])]),_:1}),t(Q,{label:"\u540D\u79F0","min-width":"100","show-overflow-tooltip":""},{default:a(({row:n})=>[t(Xe,{onClick:q(B=>pe(n.uri),["stop"]),underline:!1},{default:a(()=>[A(oe(n.name),1)]),_:2},1032,["onClick"])]),_:1}),t(Q,{prop:"createTime",label:"\u4E0A\u4F20\u65F6\u95F4","min-width":"100"}),t(Q,{label:"\u64CD\u4F5C",width:"150",fixed:"right"},{default:a(({row:n})=>[F((o(),p("div",Dt,[t(ne,{onConfirm:B=>l(Ae)(B,n.id),size:"default",value:n.name,width:"400px",limit:50,"show-limit":"",teleported:""},{default:a(()=>[t(D,{type:"primary",link:""},{default:a(()=>[A(" \u91CD\u547D\u540D ")]),_:1})]),_:2},1032,["onConfirm","value"])])),[[P,["common:album:albumRename"]]]),i("div",Bt,[t(D,{type:"primary",link:"",onClick:q(B=>pe(n.uri),["stop"])},{default:a(()=>[A(" \u67E5\u770B ")]),_:2},1032,["onClick"])]),F((o(),p("div",Rt,[t(D,{type:"primary",link:"",onClick:q(B=>l(te)([n.id]),["stop"])},{default:a(()=>[A(" \u5220\u9664 ")]),_:2},1032,["onClick"])])),[[P,["common:album:albumDel"]]])]),_:1})]),_:1},8,["data","onRowClick"]),[[ie,l(z)=="table"]]),!l(E).loading&&!l(E).lists.length?(o(),p("div",zt," \u6682\u65E0\u6570\u636E~ ")):w("",!0)]),i("div",Pt,[i("div",It,[e.mode=="page"?(o(),p(N,{key:0},[i("span",Ut,[t(_e,{disabled:!l(E).lists.length,modelValue:l(L),"onUpdate:modelValue":C[6]||(C[6]=n=>G(L)?L.value=n:null),onChange:l(Ee),indeterminate:l(s)},{default:a(()=>[A(" \u5F53\u9875\u5168\u9009 ")]),_:1},8,["disabled","modelValue","onChange","indeterminate"])]),F((o(),$(D,{disabled:!l(x).length,onClick:C[7]||(C[7]=n=>l(te)())},{default:a(()=>[A(" \u5220\u9664 ")]),_:1},8,["disabled"])),[[P,["common:album:albumDel"]]]),F((o(),$(Re,{class:"ml-3 inline",onConfirm:l(Ce),disabled:!l(x).length,title:"\u79FB\u52A8\u6587\u4EF6"},{trigger:a(()=>[t(D,{disabled:!l(x).length},{default:a(()=>[A("\u79FB\u52A8")]),_:1},8,["disabled"])]),default:a(()=>[i("div",null,[xt,t(Be,{modelValue:l(U),"onUpdate:modelValue":C[8]||(C[8]=n=>G(U)?U.value=n:null),placeholder:"\u8BF7\u9009\u62E9"},{default:a(()=>[(o(!0),p(N,null,X(l(_),n=>(o(),p(N,{key:n.id},[n.id!==""?(o(),$(De,{key:0,label:n.name,value:n.id},null,8,["label","value"])):w("",!0)],64))),128))]),_:1},8,["modelValue"])])]),_:1},8,["onConfirm","disabled"])),[[P,["common:album:albumMove"]]])],64)):w("",!0)]),t(He,{modelValue:l(E),"onUpdate:modelValue":C[9]||(C[9]=n=>G(E)?E.value=n:null),onChange:l(b),layout:"total, prev, pager, next, jumper"},null,8,["modelValue","onChange"])])]),e.mode=="picker"?(o(),p("div",Lt,[i("div",Tt,[i("div",jt,[A(" \u5DF2\u9009\u62E9 "+oe(l(x).length)+" ",1),l(v)?(o(),p("span",Mt,"/"+oe(l(v)),1)):w("",!0)]),t(D,{type:"primary",link:"",onClick:l(ke)},{default:a(()=>[A("\u6E05\u7A7A")]),_:1},8,["onClick"])]),i("div",Nt,[t(fe,{class:"ls-scrollbar"},{default:a(()=>[i("ul",Wt,[(o(!0),p(N,null,X(l(x),n=>(o(),p("li",{class:"mb-4",key:n.id},[i("div",Gt,[t(Pe,{onClose:B=>l(Ye)(n.id)},{default:a(()=>[t(se,{uri:n.uri,"file-size":"100px",type:e.type},null,8,["uri","type"])]),_:2},1032,["onClose"])])]))),128))])]),_:1})])])):w("",!0),t(We,{modelValue:l(f),"onUpdate:modelValue":C[10]||(C[10]=n=>G(f)?f.value=n:null),url:l(d),type:e.type},null,8,["modelValue","url","type"])])),[[el,l(E).loading]])}}});const Ge=le(qt,[["__scopeId","data-v-49f20224"]]),Yt=K({components:{Popup:ye,Draggable:Fl,FileItem:se,Material:Ge,Preview:We},props:{modelValue:{type:[String,Array],default:()=>[]},type:{type:String,default:"image"},size:{type:String,default:"100px"},fileSize:{type:String,default:"100px"},limit:{type:Number,default:1},disabled:{type:Boolean,default:!1},hiddenUpload:{type:Boolean,default:!1},uploadClass:{type:String,default:""},excludeDomain:{type:Boolean,default:!1}},emits:["change","update:modelValue"],setup(e,{emit:r}){const y=k(),c=k(),v=k(""),S=k(!1),u=k([]),d=k([]),f=k(!0),m=k(-1),{disabled:g,limit:_,modelValue:I}=Le(e),{getImageUrl:j}=Il(),h=Y(()=>{switch(e.type){case"image":return"\u56FE\u7247";case"video":return"\u89C6\u9891";default:return""}}),R=Y(()=>e.limit-u.value.length>0),V=Y(()=>f.value?_.value==-1?null:_.value-u.value.length:1),Z=$l(()=>{const s=d.value.map(b=>e.excludeDomain?b.path:b.uri);f.value?u.value=[...u.value,...s]:u.value.splice(m.value,1,s.shift()),E()},1e3,!1),z=s=>{var b;g.value||(s>=0?(f.value=!1,m.value=s):f.value=!0,(b=y.value)==null||b.open())},U=s=>{d.value=s},E=()=>{const s=_.value!=1?u.value:u.value[0]||"";r("update:modelValue",s),r("change",s),L()},O=s=>{u.value.splice(s,1),E()},x=s=>{v.value=s,S.value=!0},L=()=>{ge(()=>{var s;e.hiddenUpload&&(u.value=[]),(s=c.value)==null||s.clearSelect()})};return J(I,s=>{u.value=Array.isArray(s)?s:s==""?[]:[s]},{immediate:!0}),Ie("limit",e.limit),Ie("hiddenUpload",e.hiddenUpload),{popupRef:y,materialRef:c,fileList:u,tipsText:h,handleConfirm:Z,meterialLimit:V,showUpload:R,showPopup:z,selectChange:U,deleteImg:O,previewUrl:v,showPreview:S,handlePreview:x,handleClose:L,getImageUrl:j}}});const qe=e=>(je("data-v-d1489be1"),e=e(),Me(),e),Kt={class:"material-select"},Zt=["onClick"],Ot={class:"operation-btns text-xs text-center"},Qt=qe(()=>i("span",null,"\u4FEE\u6539",-1)),Xt=["onClick"],Jt=qe(()=>i("span",null,"\u6DFB\u52A0",-1)),Ht={class:"material-wrap"};function en(e,r,y,c,v,S){const u=ve("file-item"),d=Ne,f=ve("draggable"),m=re,g=Ge,_=Te,I=ye,j=ve("preview");return o(),p("div",Kt,[t(I,{ref:"popupRef",width:"830px","custom-class":"body-padding",title:`\u9009\u62E9${e.tipsText}`,onConfirm:e.handleConfirm,onClose:e.handleClose},Vl({default:a(()=>[t(_,null,{default:a(()=>[i("div",Ht,[t(g,{ref:"materialRef",type:e.type,"file-size":e.fileSize,limit:e.meterialLimit,onChange:e.selectChange},null,8,["type","file-size","limit","onChange"])])]),_:1})]),_:2},[e.hiddenUpload?void 0:{name:"trigger",fn:a(()=>[i("div",{class:"material-select__trigger clearfix",onClick:r[2]||(r[2]=q(()=>{},["stop"]))},[t(f,{class:"draggable",modelValue:e.fileList,"onUpdate:modelValue":r[0]||(r[0]=h=>e.fileList=h),animation:"300","item-key":"id"},{item:a(({element:h,index:R})=>[i("div",{class:ue(["material-preview",{"is-disabled":e.disabled,"is-one":e.limit==1}]),onClick:V=>e.showPopup(R)},[t(d,{onClose:V=>e.deleteImg(R)},{default:a(()=>[t(u,{uri:e.excludeDomain?e.getImageUrl(h):h,"file-size":e.size,type:e.type},null,8,["uri","file-size","type"])]),_:2},1032,["onClose"]),i("div",Ot,[Qt,A(" | "),i("span",{onClick:q(V=>e.handlePreview(h),["stop"])},"\u67E5\u770B",8,Xt)])],10,Zt)]),_:1},8,["modelValue"]),F(i("div",{class:ue(["material-upload",{"is-disabled":e.disabled,"is-one":e.limit==1,[e.uploadClass]:!0}]),onClick:r[1]||(r[1]=h=>e.showPopup(-1))},[de(e.$slots,"upload",{},()=>[i("div",{class:"upload-btn",style:be({width:e.size,height:e.size})},[t(m,{size:25,name:"el-icon-Plus"}),Jt],4)],!0)],2),[[ie,e.showUpload]])])]),key:"0"}]),1032,["title","onConfirm","onClose"]),t(j,{modelValue:e.showPreview,"onUpdate:modelValue":r[3]||(r[3]=h=>e.showPreview=h),url:e.previewUrl,type:e.type},null,8,["modelValue","url","type"])])}const sn=le(Yt,[["render",en],["__scopeId","data-v-d1489be1"]]);export{sn as _};
